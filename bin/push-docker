#!/bin/bash
set -e

export REPO=chanzuckerberg/idseq-web

BRANCH="branch-$1"
COMMIT="sha-$2"
BUILD_NUMBER="build-$3"

echo $BRANCH
echo $COMMIT
echo $REPO
echo $TAG
echo '--'
docker build -t $REPO:$COMMIT .
docker login -u $DOCKER_USER -p $DOCKER_PASS
docker tag $REPO:$COMMIT $REPO:$BRANCH
docker tag $REPO:$COMMIT $REPO:$BUILD_NUMBER
docker push $REPO